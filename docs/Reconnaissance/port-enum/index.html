<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Port Scanner Notes (BlackArch) ‚Äî Single Target</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; max-width: 900px; margin: 2em auto; padding: 0 1em; }
    h1, h2 { color: #2a7ae2; }
    code { background: #f4f4f4; padding: 0.2em 0.4em; border-radius: 3px; }
    pre { background: #f9f9f9; border-left: 4px solid #2a7ae2; padding: 1em; overflow-x: auto; }
    ul { margin-top: 0; }
    .tool { margin-bottom: 1.5em; }
    summary { font-weight: bold; font-size: 1.1em; cursor: pointer; color: #2a7ae2; }
    details { margin-top: 1em; }
  </style>
</head>
<body>

<h1>üìö Port Scanner Notes (BlackArch) ‚Äî Single Target</h1>

<p>This guide lists and explains popular <strong>Port Scanners</strong> available in <code>BlackArch Linux</code>, focused on scanning a <em>single</em> host (IP or domain). These tools help identify open ports, running services, and firewall configurations during reconnaissance or vulnerability assessments.</p>

<hr />

<h2>1. Popular Port Scanners (Single Target)</h2>

<div class="tool">
  <h3>‚ö° Nmap</h3>
  <p>The gold standard in port scanning and network mapping.</p>
  <pre>sudo nmap -A &lt;target&gt; -T4 -Pn</pre>
  <p><small>Examples: <code>sudo nmap -p 1-65535 -T4 -Pn &lt;target&gt;</code> (full TCP range), <code>sudo nmap -sU -T4 -Pn &lt;target&gt;</code> (UDP)</small></p>
</div>

<div class="tool">
  <h3>üöÄ RustScan</h3>
  <p>Blazingly fast port scanner written in Rust. Integrates with Nmap.</p>
  <pre>rustscan -a &lt;target&gt; --ulimit 5000 -- -A</pre>
  <p><small>RustScan finds open ports fast, then hands them to Nmap for deep service detection.</small></p>
</div>

<div class="tool">
  <h3>‚öôÔ∏è Masscan</h3>
  <p>High-speed port scanner. Use carefully on a single host.</p>
  <pre>sudo masscan &lt;target&gt; -p1-65535 --rate 1000</pre>
  <p><small>Add interface/gateway if needed: <code>--router-ip &lt;gw&gt; -e &lt;iface&gt;</code></small></p>
</div>

<div class="tool">
  <h3>üîß forkingportscanner</h3>
  <p>Simple forking port scanner by <code>magikh0e</code>.</p>
  <pre>forkingportscanner -t &lt;target&gt; -p tcp -s 1 -e 65535</pre>
</div>

<!-- üîΩ Toggleable Custom Python Tool Section -->
<details>
  <summary>üõ†Ô∏è Custom Stealth Port Scanner (Python, Single Target)</summary>
  <p>Requires <code>scapy</code>, root privileges, and Python 3. Scans one host only.</p>
  <pre><code>
#!/usr/bin/env python3
import sys
import socket
import argparse
import threading
from queue import Queue
from time import time
from scapy.all import IP, TCP, sr1, send, conf
import os

conf.verb = 0  # silence scapy
DEFAULT_THREADS = 200
DEFAULT_PORTS = "1-1024"

def parse_ports(ports_str):
    ports = set()
    for part in ports_str.split(","):
        part = part.strip()
        if "-" in part:
            a, b = part.split("-", 1)
            a, b = int(a), int(b)
            if a > b:
                a, b = b, a
            ports.update(range(a, b + 1))
        else:
            ports.add(int(part))
    return sorted(p for p in ports if 1 <= p <= 65535)

def resolve_target(target):
    try:
        return socket.gethostbyname(target)
    except socket.gaierror:
        print(f"[-] Could not resolve {target}")
        return None

def scan_port(ip, port, open_ports):
    pkt = IP(dst=ip) / TCP(dport=port, flags="S")
    resp = sr1(pkt, timeout=0.5)
    if resp is not None and resp.haslayer(TCP):
        flags = resp[TCP].flags
        # SYN/ACK means open
        if flags == 0x12:
            open_ports.append(port)
            # Send RST to be polite
            send(IP(dst=ip) / TCP(dport=port, flags="R"), verbose=0)

def worker(ip, q, open_ports):
    while True:
        try:
            port = q.get_nowait()
        except:
            break
        try:
            scan_port(ip, port, open_ports)
        finally:
            q.task_done()

def main():
    if os.geteuid() != 0:
        print("[-] Please run as root (required for raw sockets).")
        sys.exit(1)

    ap = argparse.ArgumentParser(description="Stealth TCP SYN scanner (single target)")
    ap.add_argument("target", help="IP or hostname")
    ap.add_argument("-p", "--ports", default=DEFAULT_PORTS,
                    help="Ports to scan (e.g., '1-1000' or '22,80,443,8000-8100'). Default: %(default)s")
    ap.add_argument("-t", "--threads", type=int, default=DEFAULT_THREADS,
                    help="Number of threads (default: %(default)s)")
    args = ap.parse_args()

    ip = resolve_target(args.target)
    if not ip:
        sys.exit(1)

    ports = parse_ports(args.ports)
    if not ports:
        print("[-] No valid ports to scan.")
        sys.exit(1)

    print(f"\n[~] Scanning {args.target} ({ip}) | Ports: {len(ports)} | Threads: {args.threads}")
    q = Queue()
    for p in ports:
        q.put(p)

    open_ports = []
    t0 = time()
    threads = []
    for _ in range(max(1, args.threads)):
        th = threading.Thread(target=worker, args=(ip, q, open_ports), daemon=True)
        th.start()
        threads.append(th)

    q.join()
    duration = time() - t0

    if open_ports:
        open_ports.sort()
        print(f"[+] Open ports on {ip}: {open_ports}")
        with open("scan_results.txt", "a") as f:
            f.write(f"{args.target} ({ip}): {open_ports}\n")
    else:
        print("[-] No open TCP ports found.")

    print(f"[‚úî] Finished in {duration:.2f} seconds.")

if __name__ == "__main__":
    main()
  </code></pre>

  <p><strong>Usage</strong></p>
  <pre>
sudo python3 stealth_scan.py &lt;target&gt; -p 1-65535 -t 300
# or
sudo python3 stealth_scan.py &lt;target&gt; -p 22,80,443,8000-8100 -t 150
  </pre>
</details>

<p>Scan ethically and with permission. ‚ö†Ô∏èüîí</p>

<hr />

<h2>2. Port-Scanning Tools in Kali Linux &amp; BlackArch (Single Target Usage)</h2>

<p>These are notable tools available in each distro for scanning a single host (IP or domain). Replace <code>&lt;target&gt;</code> with your host/IP.</p>

<h3>Kali Linux</h3>
<ul>
  <li><strong>Nmap</strong> ‚Äì Flexible port scanner, OS detection, scripting.<br>
      <code>sudo nmap -A &lt;target&gt; -T4 -Pn</code> (all-in-one scan)<br>
      <code>sudo nmap -p 1-65535 -T4 -Pn &lt;target&gt;</code> (full TCP range)<br>
      <code>sudo nmap -sU -T4 -Pn &lt;target&gt;</code> (UDP scan)</li>

  <li><strong>Masscan</strong> ‚Äì Very high-speed SYN scanner.<br>
      <code>sudo masscan &lt;target&gt; -p1-65535 --rate 1000</code></li>

  <li><strong>pnscan</strong> ‚Äì Multithreaded port scanner.<br>
      <code>pnscan &lt;target&gt; 1 65535</code></li>

  <li><strong>Unicornscan</strong> ‚Äì Asynchronous stateless port scanner.<br>
      <code>unicornscan &lt;target&gt;:a</code> (scan all TCP ports)</li>

  <li><strong>hping3</strong> ‚Äì Packet crafter with scanning ability.<br>
      <code>sudo hping3 -S &lt;target&gt; -p ++1-1000 -c 1</code></li>

  <li><strong>netcat (nc)</strong> ‚Äì Simple port scanner.<br>
      <code>nc -zv &lt;target&gt; 1-1024</code></li>

  <li><strong>Netdiscover</strong> ‚Äì Host discovery before scanning.<br>
      <code>netdiscover -i eth0 -P -r &lt;target&gt;/32</code></li>

  <li><strong>Kismet</strong> ‚Äì Wireless network detection.<br>
      <code>kismet -c wlan0</code> (not a direct port scan but useful pre-scan)</li>
</ul>

<h3>BlackArch Linux</h3>
<ul>
  <li><strong>kscan</strong> ‚Äì Asset mapping with port scanning.<br>
      <code>kscan -t &lt;target&gt;</code></li>

  <li><strong>krbrelayx</strong> ‚Äì Kerberos delegation abuse with scan capability.<br>
      <code>krbrelayx --target &lt;target&gt;</code></li>

  <li><strong>laf</strong> ‚Äì Login Area Finder (includes port check).<br>
      <code>laf -u http://&lt;target&gt;</code></li>

  <li><strong>lanmap2</strong> ‚Äì Passive network mapper.<br>
      <code>sudo lanmap2 -i eth0</code></li>

  <li><strong>netreconn</strong> ‚Äì Lightweight network scan/recon.<br>
      <code>netreconn -t &lt;target&gt;</code></li>

  <li><strong>Amap</strong> ‚Äì Application protocol identifier.<br>
      <code>amap &lt;target&gt; 1-65535</code></li>

  <li><strong>Nmap / Masscan</strong> ‚Äì Also available in BlackArch.<br>
      <code>sudo nmap -A &lt;target&gt; -T4 -Pn</code><br>
      <code>sudo masscan &lt;target&gt; -p1-65535 --rate 1000</code></li>
</ul>

<p><em>‚ö†Ô∏è Always scan ethically and with permission from the system owner.</em></p>


<div style="margin-top: 2em;">
  <a href="javascript:history.back()" style="text-decoration: none; font-weight: bold; font-size: 1.1em;">
    &#8592; Go Back
  </a>
</div>

</body>
</html>
